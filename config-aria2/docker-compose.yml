version: "3.5"

services:
  aria2:
    build:
      context: .
      dockerfile: Dockerfile

    image: aria2

    user: "91192:91192"

    ports:
      - 0.0.0.0:1680:6800

    environment:
      - "SECRET=<password>"

    volumes:
      - $PWD/config:/aria2/config
      - $PWD/downloads:/aria2/downloads
      - $PWD/certs:/aria2/certs

  nginx:
    image: nginx:alpine

    command: ["sh", "/etc/ngx.sh"]
    ports:
      - 0.0.0.0:1681:80

    environment:
      - "USERNAME=user"
      - "PASSWORD=<password>"

    volumes:
      - $PWD/downloads:/www
      - "$PWD/ngx_default.conf:/etc/nginx/conf.d/default.conf"
      - "$PWD/ngx.sh:/etc/ngx.sh"
#      - "$PWD/nginx.conf:/etc/nginx/nginx.conf"
